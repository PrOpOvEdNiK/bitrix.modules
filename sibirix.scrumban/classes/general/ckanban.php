<? $GLOBALS['_1371504561_']=Array(base64_decode('cmVhbHBhd' .'Gg='),base64_decode('ZGl' .'y' .'b' .'mFtZQ=='),base64_decode('ZGlyb' .'mFt' .'ZQ=='),base64_decode('ZGVm' .'aW5' .'lZA=' .'='),base64_decode('c3Ry' .'cG9z'),base64_decode('' .'Z2V0X' .'2lu' .'Y2' .'x' .'1ZGV' .'fcGF0' .'aA=' .'='),base64_decode('b' .'XRfcmF' .'uZA' .'=' .'='),base64_decode('ZG' .'VmaW5' .'lZA=='),base64_decode('Z' .'GV' .'maW5l'),base64_decode('ZGVmaW5' .'l' .'ZA=='),base64_decode('ZGVma' .'W5l'),base64_decode('ZG' .'VmaW5' .'lZA' .'=='),base64_decode('' .'Z' .'G' .'V' .'maW' .'5l'),base64_decode('Z' .'G' .'VmaW5' .'lZA=='),base64_decode('ZGVmaW5l'),base64_decode('ZGVm' .'aW5lZA=' .'='),base64_decode('ZGVm' .'aW5l'),base64_decode('ZGV' .'maW' .'5lZA=' .'='),base64_decode('ZG' .'VmaW5' .'l'),base64_decode('ZGVma' .'W5' .'lZA=' .'='),base64_decode('ZGV' .'maW5l'),base64_decode('ZGVm' .'aW5lZA' .'=='),base64_decode('Z' .'GVmaW5l'),base64_decode('dW' .'Fzb3J0'),base64_decode('' .'b' .'X' .'R' .'f' .'c' .'m' .'FuZA=='),base64_decode('' .'Z' .'GVm' .'aW5lZA=='),base64_decode('ZGVmaW5l'),base64_decode('ZGV' .'maW5l' .'Z' .'A' .'=='),base64_decode('ZGVmaW5l'),base64_decode('c3RydmFs'),base64_decode('bXR' .'f' .'cm' .'FuZA=='),base64_decode('' .'ZGVma' .'W5l' .'ZA=='),base64_decode('ZGVma' .'W5l'),base64_decode('ZGVmaW5lZA' .'=='),base64_decode('Z' .'GVmaW5' .'l'),base64_decode('ZGVmaW5lZ' .'A' .'=='),base64_decode('ZGVmaW5' .'l'),base64_decode('Z' .'GlybmFtZ' .'Q' .'=' .'='),base64_decode('ZGVmaW5l'),base64_decode('c2V0' .'X2luY2x1ZGVfc' .'G' .'F0aA' .'=='),base64_decode('aW1wb' .'G9k' .'ZQ=='),base64_decode('c' .'m' .'VhbH' .'BhdGg='),base64_decode('Z' .'GlybmFtZQ=='),base64_decode('' .'c' .'mVhb' .'H' .'Bhd' .'Gg='),base64_decode('ZGly' .'bmFtZQ=='),base64_decode('Z2V0X2lu' .'Y' .'2x1Z' .'GV' .'fcGF0' .'aA=='),base64_decode('c3RycmV2'),base64_decode('YXJyY' .'Xlfa2V' .'5X2' .'V4aXN0' .'cw=='),base64_decode('ZmZ' .'sd' .'XNo'),base64_decode('' .'c' .'3' .'Ryc' .'G9' .'z'),base64_decode('c29ja2V0X' .'2dldF' .'9vcHRp' .'b24='),base64_decode('' .'c' .'3RyX3JlcGxhY' .'2' .'U='),base64_decode('' .'b' .'X' .'R' .'fcmFuZA=='),base64_decode('Y3Vyb' .'F' .'9zZXRvcHQ='),base64_decode('aW1' .'hZ2' .'V' .'j' .'b3B5bWVyZ2V' .'ncmF5'),base64_decode('' .'c' .'3' .'RycG9z'),base64_decode('c' .'2V' .'zc2' .'lv' .'bl9' .'nZXRf' .'Y29va2l' .'lX3BhcmFtcw=='),base64_decode('' .'bXRfc' .'mFuZA=='),base64_decode('Y' .'XJ' .'yYX' .'lf' .'a' .'W50ZXJzZW' .'N' .'0'),base64_decode('c3R' .'ycG9z'),base64_decode('c3' .'RycG9' .'z'),base64_decode('' .'c3R' .'ycG9z'),base64_decode('Y2hy'),base64_decode('c2' .'h' .'hMQ' .'=='),base64_decode('Y' .'3V' .'ybF9' .'zZXRvcHQ='),base64_decode('bXRfcmF' .'uZA=='),base64_decode('c3RycG9z'),base64_decode('c' .'3RyX3JlcGxhY2U' .'='),base64_decode('cHJ' .'lZ19' .'tYXRjaA=='),base64_decode('' .'cHJl' .'Z19tYXRjaA=='),base64_decode('a' .'W' .'5' .'0' .'dm' .'F' .'s'),base64_decode('bXRfcmF' .'uZA' .'=='),base64_decode('' .'YWJz'),base64_decode('aW5fYX' .'JyYXk='),base64_decode('c' .'29ja2V0X2dldF9vc' .'HRpb24='),base64_decode('bX' .'Rfc' .'mFuZA' .'=='),base64_decode('' .'Y2x' .'hc3NfZXhpc3' .'Rz'),base64_decode('c' .'3RycmV' .'2'),base64_decode('' .'bX' .'RfcmFuZA=='),base64_decode('anN' .'vbl9lb' .'mNvZG' .'U='),base64_decode('c3Ryd' .'H' .'I' .'='),base64_decode('aW1hZ2VjcmVhdG' .'Vmcm9tZ2' .'lm'),base64_decode('YXJy' .'Y' .'Xlfa2V5cw=='),base64_decode('c3R' .'ycG9' .'z'),base64_decode('YXJyY' .'Xlfcm' .'FuZA=='),base64_decode('Y2' .'xhc3NfZXhpc3Rz'),base64_decode('Zml' .'s' .'ZV9leGlzd' .'H' .'M' .'='),base64_decode('Y' .'2xhc3' .'NfZ' .'Xhpc3R' .'z'),base64_decode('' .'bX' .'R' .'fc' .'mFuZA=='),base64_decode('b' .'X' .'RfcmF' .'uZA=='),base64_decode('ZmlsZV9n' .'Z' .'XRfY29udGVudHM='),base64_decode('bXRfc' .'mFuZA=='),base64_decode('YXJ' .'yYXlfc' .'mV2ZXJzZQ=='),base64_decode('' .'ZGVm' .'a' .'W5' .'l' .'Z' .'A=' .'='),base64_decode('' .'c3R' .'ycG9z'),base64_decode('Z' .'mlsZV9leGlzd' .'HM='),base64_decode('ZmlsZ' .'V9le' .'Glzd' .'HM' .'='),base64_decode('ZmlsZV9' .'l' .'eGlzdHM='),base64_decode('' .'Zm' .'lsZV9le' .'G' .'lzdHM='),base64_decode('' .'Zmls' .'Z' .'V9leGlzd' .'H' .'M' .'='),base64_decode('' .'ZmlsZV9l' .'e' .'GlzdHM='),base64_decode('bXRfcmFuZ' .'A' .'=='),base64_decode('Y3VybF9td' .'Wx0aV9nZXRjb' .'2' .'5' .'0Z' .'W5' .'0'),base64_decode('' .'ZGVma' .'W5l'),base64_decode('c3' .'RycG9z'),base64_decode('' .'ZGly'),base64_decode('c3' .'RycG9z'),base64_decode('c3Ry' .'cmN' .'ocg=='),base64_decode('c3' .'RycG' .'9z'),base64_decode('dW5saW5r'),base64_decode('ZX' .'hwbG9kZQ=='),base64_decode('aW1hZ2VjcmVhdGVmcm9tcG' .'5n'),base64_decode('aW50dmFs'),base64_decode('aXNf' .'Y' .'XJyYXk='),base64_decode('aXN' .'fY' .'XJyYXk' .'='),base64_decode('aXNf' .'YXJyY' .'Xk='),base64_decode('cmVh' .'bHBhdGg='),base64_decode('c' .'3RycG9' .'z'),base64_decode('ZGF0Z' .'Q=='),base64_decode('ZG' .'F0Z' .'Q=='),base64_decode('Y29' .'1bnQ='),base64_decode('c' .'3' .'Ry' .'cG9z'),base64_decode('c3' .'Ryc' .'m' .'Nocg=='),base64_decode('bXRfcmFu' .'ZA=' .'='),base64_decode('aW1hZ2VjcmVh' .'d' .'GVmc' .'m9tZ' .'2' .'l' .'m'),base64_decode('c3RycG9z'),base64_decode('b' .'XR' .'fcmFuZA=='),base64_decode('ZXhwbG9kZQ=='),base64_decode('bmw' .'yYnI='),base64_decode('b' .'Wt' .'0' .'aW' .'1l'),base64_decode('' .'Y29' .'1' .'bnQ='),base64_decode('Y' .'X' .'JyYXlfaW50Z' .'XJzZ' .'WN' .'0'),base64_decode('cm91bm' .'Q='),base64_decode('dG' .'ltZQ=='),base64_decode('c3RydG90aW' .'1' .'l'),base64_decode('c2h' .'hM' .'V9maWxl'),base64_decode('c3' .'RycG9' .'z'),base64_decode('cHJlZ1' .'9x' .'dW90ZQ=' .'='),base64_decode('bXR' .'fc' .'mFuZ' .'A=='),base64_decode('ZmlsZV' .'9le' .'G' .'lzdHM' .'='),base64_decode('' .'c3Ryc' .'G9z'),base64_decode('Y29' .'1bnQ' .'='),base64_decode('YXJyYXlfZG' .'lmZl91YXNzb2M='),base64_decode('b2JfY2xl' .'Y' .'W4='),base64_decode('bX' .'RfcmFuZA' .'=='),base64_decode('aW1wbG9kZQ=='),base64_decode('' .'bX' .'Rf' .'c' .'mFu' .'ZA=' .'='),base64_decode('ZXhwbG9k' .'ZQ=='),base64_decode('bXRfcmF' .'uZ' .'A=='),base64_decode('c2' .'9j' .'a2V' .'0X2N' .'yZ' .'WF0ZV' .'9wYWl' .'y'),base64_decode('ZGVmaW' .'5' .'l'),base64_decode('bXRfcmF' .'uZA=' .'='),base64_decode('aW1wbG9k' .'ZQ' .'=='),base64_decode('YXJyYXlfa2V5' .'cw=='),base64_decode('' .'ZGVmaW5l'),base64_decode('bXRfcmFuZA=='),base64_decode('Y291bn' .'Q='),base64_decode('YXJy' .'YX' .'lf' .'aW50Z' .'XJzZWN' .'0'),base64_decode('c3R' .'yd' .'G90aW1l'),base64_decode('bXRfcmFuZA=' .'='),base64_decode('' .'c3R' .'ycm' .'Nocg=='),base64_decode('dG' .'ltZQ' .'=='),base64_decode('c3' .'Ry' .'dG90aW1l'),base64_decode('' .'d' .'GltZ' .'Q=='),base64_decode('Y2' .'hy'),base64_decode('Y2hy'),base64_decode('Y2h' .'y'),base64_decode('Y' .'2hy'),base64_decode('' .'Y' .'2hy'),base64_decode('Y2hy'),base64_decode('c3RycG9' .'z'),base64_decode('c3RydG91c' .'HBlcg=='),base64_decode('c3RycG9' .'z'),base64_decode('' .'c3Ryc' .'G9z'),base64_decode('c3RycG9z'),base64_decode('c3RydG9s' .'b' .'3dl' .'cg=='),base64_decode('Y2' .'91' .'bnQ' .'='),base64_decode('dGltZ' .'Q=='),base64_decode('' .'YXJ' .'yYXlfcmFuZA=='),base64_decode('' .'c3Ryc' .'G9' .'z'),base64_decode('' .'c2hlbGx' .'fZXhlYw=='),base64_decode('ZXh' .'wbG9kZQ=='),base64_decode('YXJ' .'yYX' .'lfc2hpZnQ='),base64_decode('b' .'XRfcmF' .'uZA=='),base64_decode('' .'c3R' .'ycmN' .'oc' .'g=='),base64_decode('Y291' .'bnQ='),base64_decode('Y' .'29' .'1b' .'nQ='),base64_decode('Y' .'X' .'JyYXlf' .'d' .'W5' .'pcXVl'),base64_decode('' .'YXJyYXl' .'fbWVyZ2U='),base64_decode('YXJyYX' .'l' .'fd' .'W5pcXVl'),base64_decode('c' .'3RycG9z'),base64_decode('bXR' .'fcmF' .'uZA=='),base64_decode('bWtka' .'XI='),base64_decode('bX' .'R' .'f' .'cmFuZA=='),base64_decode('YX' .'J' .'y' .'Y' .'XlfZmxpc' .'A=='),base64_decode('YW' .'Nv' .'cw=='),base64_decode('' .'bXR' .'f' .'cmFuZ' .'A=='),base64_decode('a' .'m9p' .'bg=='),base64_decode('bXRfcm' .'FuZA=='),base64_decode('ZGF0Z' .'Q=' .'='),base64_decode('c3RydG' .'90' .'aW' .'1' .'l'),base64_decode('bXRf' .'cmF' .'uZA' .'=='),base64_decode('dX' .'JsZGV' .'jb2Rl'),base64_decode('ZGF0Z' .'Q=='),base64_decode('c3RydG9' .'0aW' .'1' .'l'),base64_decode('c3' .'Ry' .'X3JlcG' .'xhY2U' .'='),base64_decode('b' .'X' .'RfcmFuZA=' .'='),base64_decode('c3By' .'aW50Zg=='),base64_decode('c3ByaW50Zg=='),base64_decode('' .'c3ByaW50Zg=='),base64_decode('c3RycG9z'),base64_decode('aW1hZ2Vjb3B5cm' .'V' .'zaXplZA=' .'='),base64_decode('Y' .'291' .'bnQ='),base64_decode('bX' .'RfcmF' .'uZA=' .'='),base64_decode('bXRfc' .'m' .'FuZA=='),base64_decode('' .'Y291bn' .'Q='),base64_decode('' .'d' .'GltZQ' .'=='),base64_decode('c3Vic3' .'RyX2Nv' .'bXBhcmU='),base64_decode('YXJyYXlfa2V' .'5cw=='),base64_decode('bXRf' .'cmFu' .'ZA=' .'='),base64_decode('aW' .'5' .'fYXJyYXk='),base64_decode('c3' .'RycG9z'),base64_decode('cGF' .'j' .'aw=' .'='),base64_decode('bWtkaX' .'I' .'='),base64_decode('c3Ryc' .'G9z'),base64_decode('YX' .'Jy' .'YXlfZmxpcA=='),base64_decode('ZGF0ZQ' .'=='),base64_decode('c3R' .'ydG9' .'0aW1' .'l'),base64_decode('Z' .'md' .'ldGM='),base64_decode('ZG' .'F0' .'ZQ=='),base64_decode('c3Ryd' .'G90a' .'W1l'),base64_decode('c3' .'By' .'a' .'W50' .'Zg=='),base64_decode('c3' .'By' .'aW5' .'0Zg=' .'='),base64_decode('bXl' .'zcWxfY2xvc2U='),base64_decode('c' .'3ByaW50Zg=='),base64_decode('' .'c3Ryc' .'G9z'),base64_decode('dHJpbQ=='),base64_decode('' .'bX' .'RfcmFu' .'ZA=' .'='),base64_decode('Zml' .'sZQ=='),base64_decode('c3RycG9z'),base64_decode('bXRfc' .'mFuZA=='),base64_decode('bXR' .'fcmFuZA=='),base64_decode('a' .'W1hZ2' .'VjcmVhdGVmc' .'m9t' .'Z' .'2Q' .'='),base64_decode('am' .'9p' .'bg' .'=='),base64_decode('c' .'3R' .'y' .'c' .'G9' .'z'),base64_decode('Y' .'XJyYXl' .'fcHJvZH' .'VjdA=='),base64_decode('bXRfc' .'mF' .'u' .'Z' .'A' .'=' .'='),base64_decode('aW' .'1hZ2' .'VjcmVh' .'d' .'GU='),base64_decode('dG' .'ltZQ=='),base64_decode('Zm' .'l' .'s' .'Z' .'W' .'F0aW1l'),base64_decode('b' .'XRfcmFuZA=='),base64_decode('c29ydA=' .'='),base64_decode('b' .'XRf' .'cmFuZA=='),base64_decode('YXJyY' .'XlfcG9w'),base64_decode('' .'c3' .'RydG90aW1l'),base64_decode('bX' .'RfcmFuZA=='),base64_decode('ZmRm' .'X3' .'NldF92ZXJzaW9u'),base64_decode('cm91bmQ='),base64_decode('bXR' .'f' .'cm' .'F' .'uZA=='),base64_decode('Y' .'3V' .'y' .'cmVudA=='),base64_decode('dmFyX2R' .'1bXA' .'='),base64_decode('' .'bX' .'Rfcm' .'FuZA=='),base64_decode('aW1h' .'Z2Vma' .'Wx0Z' .'XI='),base64_decode('c29y' .'dA' .'=='),base64_decode('YXJyY' .'Xl' .'fc' .'2V' .'hcmNo'),base64_decode('c' .'3B' .'yaW50' .'Zg=='),base64_decode('bXR' .'fcmFuZA=='),base64_decode('bXR' .'fcmFu' .'ZA=='),base64_decode('aXNfYXJ' .'yYXk='),base64_decode('c' .'3Ryc' .'G9z'),base64_decode('YXJyYXlfa2' .'V5' .'cw=' .'='),base64_decode('c3' .'Ryc' .'G9z'),base64_decode('b' .'XR' .'fc' .'mFuZA=='),base64_decode('YXJyYXlf' .'Zml' .'sd' .'GVy'),base64_decode('' .'Ym' .'FzZTY' .'0X2' .'RlY29' .'kZQ=='),base64_decode('' .'aW1wbG9kZQ=='),base64_decode('aW1wbG' .'9k' .'ZQ=' .'='),base64_decode('bXRfcmFuZ' .'A=='),base64_decode('' .'c' .'29ja2V0X2d' .'l' .'d' .'F' .'9' .'v' .'cHRpb24='),base64_decode('c3Ryc' .'G' .'9z'),base64_decode('cmVhbHBh' .'dG' .'g='),base64_decode('ZmlsZ' .'V' .'9le' .'G' .'l' .'zdH' .'M='),base64_decode('ZmlsZV9n' .'ZXRfY29udG' .'VudHM' .'='),base64_decode('cHJl' .'Z19t' .'YXR' .'jaF9hb' .'G' .'w='),base64_decode('c3' .'Bya' .'W50Zg=' .'='),base64_decode('c' .'HJlZ19yZXBsY' .'WNl'),base64_decode('c3' .'Ryc3Bu'),base64_decode('c' .'3' .'Ry' .'X3J' .'lcGx' .'h' .'Y2U='),base64_decode('Y' .'2hy'),base64_decode('c' .'HJ' .'lZ19yZX' .'BsYW' .'N' .'l'),base64_decode('c29ja2V0X2Ny' .'ZW' .'F0ZV9wYWly'),base64_decode('bXRfcmFu' .'Z' .'A=='),base64_decode('' .'c' .'3' .'RyX' .'3JlcGxhY2U='),base64_decode('' .'Y2hy'),base64_decode('c' .'HJlZ' .'19yZ' .'X' .'BsYWNl')); ?><? class CKanban{private $_zend;private $_zendRun=false;private $_params;const MODULE_ID="sibirix.scrumban";const LICENCE_EMAIL="scrumban@sibirix.ru";const EXPIRE_ALERT_DAYS=5;public static function getInstance($params=array()){static $_instance;$cltkqjdlgkehjqgq=4798;if(!isset($_instance)){$_instance=new self($params);}if(!empty($params)){$_instance->setParams($params);}return $_instance;}final private function __clone(){}final private function __wakeup(){}final private function __construct(){}public function setParams($params){if(!isset($params['APPLICATION_PATH'])|| empty($params['APPLICATION_PATH'])){$params['APPLICATION_PATH']=$GLOBALS['_1371504561_'][0]($GLOBALS['_1371504561_'][1](__FILE__) .DIRECTORY_SEPARATOR .'application');}if(!isset($params['BASE_PATH'])|| empty($params['BASE_PATH'])){$params['BASE_PATH']=$GLOBALS['_1371504561_'][2](__FILE__);}$this->_params=$params;}private function _isComponentRunning(){return $this->_zendRun;}public function run(){if($GLOBALS['_1371504561_'][3]('CKANBAN_DETECT_AUTHORIZE')){global $APPLICATION;LocalRedirect($APPLICATION->GetCurUri());return;if($GLOBALS['_1371504561_'][4]('ccgrijsrxejotqebfouil','upaz')!==false)LANG_CHARSET($projectModel,$ID);}$this->_zendRun=true;if((1631+1320)>1631 || isExtranetActive($hasLog,$data,$isProjectRightsManagementActive));else{$GLOBALS['_1371504561_'][5]($rsSites,$comment,$moduleInfo);}$this->initZend();$this->_zend->run();if(6706<$GLOBALS['_1371504561_'][6](3097,3604))ID($base,$scrumban,$ckanban);if(Zend_Controller_Front::getInstance()->getResponse()->isRedirect()){header('HTTP/1.1 ' .Zend_Controller_Front::getInstance()->getResponse()->getHttpResponseCode());}}public function initZend(){if(isset($this->_zend)){return;}$options=new COption();$GLOBALS['_1371504561_'][7]('CKANBAN_VIEW_ENCODING')|| $GLOBALS['_1371504561_'][8]('CKANBAN_VIEW_ENCODING',ToUpper(LANG_CHARSET));if((4355+1417)>4355 || ACCOMPLICES($taskIdList,$user,$order));else{addMenuElement($groupId);}$GLOBALS['_1371504561_'][9]('DEFAULT_RESPONSIBLE_USER')|| $GLOBALS['_1371504561_'][10]('DEFAULT_RESPONSIBLE_USER',CKanban::getDefaultResponsibleTaskId());$obwrvhwhssurjxnks='a';$GLOBALS['_1371504561_'][11]('APPLICATION_PATH')|| $GLOBALS['_1371504561_'][12]('APPLICATION_PATH',$this->_params['APPLICATION_PATH']);$GLOBALS['_1371504561_'][13]('BASE_PATH')|| $GLOBALS['_1371504561_'][14]('BASE_PATH',$this->_params['BASE_PATH']);$GLOBALS['_1371504561_'][15]('APPLICATION_ENV')|| $GLOBALS['_1371504561_'][16]('APPLICATION_ENV',$this->_params['APPLICATION_ENV']);$GLOBALS['_1371504561_'][17]('DURATION_WORKING_DAY')|| $GLOBALS['_1371504561_'][18]('DURATION_WORKING_DAY',$this->_params['DURATION_WORKING_DAY']);$GLOBALS['_1371504561_'][19]('BASE_DOMAIN')|| $GLOBALS['_1371504561_'][20]('BASE_DOMAIN',$_SERVER['SERVER_NAME']);$GLOBALS['_1371504561_'][21]('TASK_FILES_WIDE_PREVIEW_WIDTH')|| $GLOBALS['_1371504561_'][22]('TASK_FILES_WIDE_PREVIEW_WIDTH',196);(2599-2599+3554-3554)?$GLOBALS['_1371504561_'][23]($newColumn):$GLOBALS['_1371504561_'][24](1263,2599);$GLOBALS['_1371504561_'][25]('TASK_FILES_PREVIEW_WIDTH')|| $GLOBALS['_1371504561_'][26]('TASK_FILES_PREVIEW_WIDTH',112);$GLOBALS['_1371504561_'][27]('TASK_FILES_PREVIEW_HEIGHT')|| $GLOBALS['_1371504561_'][28]('TASK_FILES_PREVIEW_HEIGHT',112);(3229-3229+4535-4535)?$GLOBALS['_1371504561_'][29]($cacheTime,$userList,$actAct,$url):$GLOBALS['_1371504561_'][30](3229,3301);$GLOBALS['_1371504561_'][31]("BITRIX_UPLOAD_FOLDER")|| $GLOBALS['_1371504561_'][32]("BITRIX_UPLOAD_FOLDER",$options->GetOptionString("main","upload_dir","upload"));$GLOBALS['_1371504561_'][33]("SCRUMBAN_UPLOAD_TEMP_FOLDER")|| $GLOBALS['_1371504561_'][34]("SCRUMBAN_UPLOAD_TEMP_FOLDER",BITRIX_UPLOAD_FOLDER .DIRECTORY_SEPARATOR ."scrumban_temp" .DIRECTORY_SEPARATOR);$path=$_SERVER['REAL_FILE_PATH'];$gbxbvlndtbhmgf='hx';if(empty($path)){$path=strlen($_SERVER['PHP_SELF'])<strlen($_SERVER['SCRIPT_NAME'])?$_SERVER['PHP_SELF']:$_SERVER['SCRIPT_NAME'];}$GLOBALS['_1371504561_'][35]("SCRUMBAN_BASE_URL")|| $GLOBALS['_1371504561_'][36]("SCRUMBAN_BASE_URL",$GLOBALS['_1371504561_'][37]($path));$this->check();$GLOBALS['_1371504561_'][38]('APPLICATION_BACKEND','bitrix');$GLOBALS['_1371504561_'][39]($GLOBALS['_1371504561_'][40](PATH_SEPARATOR,array($GLOBALS['_1371504561_'][41]($GLOBALS['_1371504561_'][42](__FILE__) .DIRECTORY_SEPARATOR .'..' .DIRECTORY_SEPARATOR .'include/extends'),$GLOBALS['_1371504561_'][43]($GLOBALS['_1371504561_'][44](__FILE__) .DIRECTORY_SEPARATOR .'..' .DIRECTORY_SEPARATOR .'include/library'),$GLOBALS['_1371504561_'][45](),)));if((1465^1465)&& EndDataCache($acc,$scrumbanPageControllsConfig,$lastComment))$GLOBALS['_1371504561_'][46]($projectList,$mailParams,$n100);require_once 'Zend/Application.php';while(1561-1561)$GLOBALS['_1371504561_'][47]($cacheTime);$this->_zend=new Zend_Application(APPLICATION_ENV,APPLICATION_PATH .DIRECTORY_SEPARATOR .'backends' .DIRECTORY_SEPARATOR .APPLICATION_BACKEND .DIRECTORY_SEPARATOR .'configs' .DIRECTORY_SEPARATOR .'application.ini');$this->_zend->bootstrap();$udnmgjxlordfpqoj=3744;}private function check(){}function prepareMessage($msg){$msg=GetMessage($msg);$vfhnsbtcjvncvd='di';$options=new COption();if((4088^4088)&& GetByID($comment,$lastComments))Send($module);$url=$options->GetOptionString("main","server_name",$GLOBALS["SERVER_NAME"]);$name=$options->GetOptionString("main","site_name",$GLOBALS["SERVER_NAME"]);if((2786^2786)&& $GLOBALS['_1371504561_'][48]($GLOBALS,$added,$arInsert))InitCache($watcher,$commentCreated,$diff);$email=$options->GetOptionString("main","email_from");if($GLOBALS['_1371504561_'][49]('bgutjvacmous','oqz')!==false)$GLOBALS['_1371504561_'][50]($taskModel,$dateFromTs,$name);$msg=$GLOBALS['_1371504561_'][51](array("#EMAIL#","#NAME#","#URL#"),array($email,$name,$url),$msg);$dipghhonjnsnrgpixwei=544;return $msg;}static function onTaskAdd($ID,$arFields){$arInsert=array('BACKEND_TASK_ID'=> $ID,'GROUP_ID'=>!empty($arFields['GROUP_ID'])?$arFields['GROUP_ID']:'NULL','EVENT'=> "'A'");self::getInstance()->_addSyncLogRow($arInsert);}static function onTaskDelete($ID){$arInsert=array('BACKEND_TASK_ID'=> $ID,'GROUP_ID'=> 'NULL','EVENT'=> "'D'");self::getInstance()->_addSyncLogRow($arInsert);if(6877<$GLOBALS['_1371504561_'][52](3424,3448))$GLOBALS['_1371504561_'][53]($user,$arTask);}static function onTaskUpdate($ID,$arFields){$arInsert=array('BACKEND_TASK_ID'=> $ID,'EVENT'=> "'U'");if((1110^1110)&& OnPullGetDependentModule($dbFile,$watcher))$GLOBALS['_1371504561_'][54]($userRes);self::getInstance()->_addSyncLogRow($arInsert);$vmxfhxfhxseknms='vlt';}static function onSocNetGroupAdd($ID,$arFields){$arInsert=array('GROUP_ID'=> $ID,'EVENT'=> "'A'");self::getInstance()->_addSyncLogRow($arInsert);}public static function addMenuElement(){global $APPLICATION;static $added=false;if($added)return;$scrumbanModuleId='sibirix.scrumban';$scrumban=self::isScrumbanActive($scrumbanModuleId);if($GLOBALS['_1371504561_'][55]('kacwiteheeadcqifj','kegz')!==false)$GLOBALS['_1371504561_'][56]($userByTaskRow,$deps,$watcher);$isExtranetActive=self::isExtranetActive();if(2050<$GLOBALS['_1371504561_'][57](112,1933))$GLOBALS['_1371504561_'][58]($isExtranetActive,$boardModel,$days);$isInScrumban=($GLOBALS['_1371504561_'][59]($APPLICATION->GetCurPage(),"/scrumban/")!== false);$isInAdmin=($GLOBALS['_1371504561_'][60]($APPLICATION->GetCurPage(),"/bitrix/")!== false);$options=new COption();if($GLOBALS['_1371504561_'][61]('vrocrcpohhbiqae','lmz')!==false)$GLOBALS['_1371504561_'][62]($commentCreated);$forbidden=$options->GetOptionString(self::MODULE_ID,'hideMenuItems','');if((2874^2874)&& $GLOBALS['_1371504561_'][63]($projectModel,$domains))BITRIX_UPLOAD_FOLDER($_zendRun,$comment,$topicId,$taskToken);$forbidden=(strlen($forbidden)>0);(1814-1814+4141-4141)?$GLOBALS['_1371504561_'][64]($btm,$activity):$GLOBALS['_1371504561_'][65](1532,1814);if($scrumban && $isExtranetActive &&!$isInAdmin &&!$isInScrumban &&!$forbidden){global $APPLICATION;$wgId=false;$taskId=false;if($GLOBALS['_1371504561_'][66]('ejsxrlcrsgmaxxrq','ewvrpz')!==false)strlen($user,$watcher,$scrumban,$errors);$group_path_template=$options->GetOptionString("socialnetwork","group_path_template");$taskPattern="task\/[^\d]*(\d+)\/";$wgPattern=$GLOBALS['_1371504561_'][67](array('#group_id#','/'),array('(\d+)','\/'),$group_path_template);if($GLOBALS['_1371504561_'][68]('/' .$wgPattern .'(.*)/',$APPLICATION->GetCurDir(),$match)>0){$wgId=$match[1];$taskToken=$match[2];}else{$taskToken=$APPLICATION->GetCurDir();$sfltpivalcoisjhbbv=2545;}if($GLOBALS['_1371504561_'][69]('/' .$taskPattern .'/',$taskToken,$match)>0){$taskId=$match[1];}$projectIdList=self::getProjectIdList();if($projectIdList !== false){if(CModule::IncludeModule("tasks")){if($taskId !== false){$rsTask=CTasks::GetByID($taskId);if($arTask=$rsTask->GetNext()){$wgId=$GLOBALS['_1371504561_'][70]($arTask['GROUP_ID']);$wgId=($wgId>0)?$wgId:false;}else{$taskId=false;$wgId=false;if(2155<$GLOBALS['_1371504561_'][71](532,1618))$GLOBALS['_1371504561_'][72]($arUser,$project,$userIdResponsibleFalse);}}else{$taskId=false;}if($wgId !== false &&!$GLOBALS['_1371504561_'][73]($wgId,$projectIdList)){$wgId=false;}}else{$taskId=false;$wgId=false;if((3571+3202)>3571 || wordEnding($siteId,$base));else{$GLOBALS['_1371504561_'][74]($str,$userRes,$hasLog);}}}IncludeModuleLangFile(__FILE__);(4251-4251+1594-1594)?TITLE($customerGroups,$strByProject,$idList):$GLOBALS['_1371504561_'][75](1134,4251);$scrumbanPageControllsConfig=array('WORKGROUP_ID'=> $wgId,'TASK_ID'=> $taskId,'EXTRANET_SITE_ID'=> $options->GetOptionString("extranet","extranet_site"),'l10n'=> array('SCRUMBAN_TASK_BOARD'=> $APPLICATION->ConvertCharset(GetMessage('SCRUMBAN_MENU_KANBAN'),LANG_CHARSET,"UTF-8"),'SCRUMBAN_PLANNING_BOARD'=> $APPLICATION->ConvertCharset(GetMessage('SCRUMBAN_MENU_PLANNING'),LANG_CHARSET,"UTF-8"),'SCRUMBAN_TASK'=> $APPLICATION->ConvertCharset(GetMessage('SCRUMBAN_MENU_PLANNING'),LANG_CHARSET,"UTF-8")),'IS_EXTRANET'=> $GLOBALS['_1371504561_'][76]('CExtranet')&& CExtranet::IsExtranetSite());(3345-3345+448-448)?$GLOBALS['_1371504561_'][77]($cacheTime):$GLOBALS['_1371504561_'][78](3188,3345);$path="/bitrix/components/sibirix/scrumban/static/images/sprite-icons.png";$APPLICATION->AddHeadString("<style>.task-list-toolbar-scrumban .webform-small-button-icon { background: url('" .$path ."') 0 -90px no-repeat; width: 15px; height: 12px; top: 13px; }</style>");$APPLICATION->AddHeadString('<script type="text/javascript">/* BX_DEBUG_INFO */if (window.scrumban === undefined) window.scrumban = {}; window.scrumban.SITE_DIR = "' .SITE_DIR .'"; window.scrumban.SITE_TEMPLATE = "' .self::detectBitrixTemplate() .'"; window.scrumban.scrumbanPageControllsConfig = ' .$GLOBALS['_1371504561_'][79]($scrumbanPageControllsConfig) .'; </script>');if((1576+724)>1576 || checkSupportDailyNotify($userIdList));else{$GLOBALS['_1371504561_'][80]($APPLICATION);}$APPLICATION->AddHeadString("<script type='text/javascript' src='/bitrix/components/sibirix/scrumban/js/add-menu.js'></script>");while(424-424)$GLOBALS['_1371504561_'][81]($matches,$hasSos,$colList,$userByTask);}$added=true;if((2563^2563)&& where($activityByTask))$GLOBALS['_1371504561_'][82]($user,$isInScrumban);}private static function isScrumbanActive($scrumbanModuleId){$module=new CModule();if($GLOBALS['_1371504561_'][83]('oonbacefrfjqstpu','uamz')!==false)$GLOBALS['_1371504561_'][84]($strByProject,$isProjectRightsManagementActive,$colModel);$scrumban=$module->IncludeModule($scrumbanModuleId);if(!$scrumban ||!$GLOBALS['_1371504561_'][85]('CKanban')){if($GLOBALS['_1371504561_'][86]($_SERVER['DOCUMENT_ROOT'] .'/bitrix/modules/' .$scrumbanModuleId .'/options/optionsHelper.php')){include_once($_SERVER['DOCUMENT_ROOT'] .'/bitrix/modules/' .$scrumbanModuleId .'/options/optionsHelper.php');if($GLOBALS['_1371504561_'][87]('OptionsHelper')&& OptionsHelper::partnerModuleManualStart()){include(GetLangFileName($_SERVER["DOCUMENT_ROOT"] .'/bitrix/modules/' .$scrumbanModuleId .'/lang/','/general.php'));$scrumban=true;}}}return $scrumban;if(7552<$GLOBALS['_1371504561_'][88](3573,3974))__CollectRequestData($arInsert,$taskToken);}private static function isExtranetActive(){$isExtranetActive=true;while(3683-3683)Model_Db_Kanban_Column($author,$login,$toArchiveAfter,$taskActivity);$options=new COption();$module=new CModule();if(4103<$GLOBALS['_1371504561_'][89](866,3232))$GLOBALS['_1371504561_'][90]($projectId,$_SERVER);if($module->IncludeModule('extranet')){if(CExtranet::GetExtranetSiteID()== SITE_ID){if(!$options->GetOptionString('sibirix.scrumban','extranetActive',true)){$isExtranetActive=false;}}}return $isExtranetActive;}private static function getProjectIdList(){global $DB;$options=new COption();(571-571+1175-1175)?LANG($domain,$ID,$moduleInfo,$remain,$siteId):$GLOBALS['_1371504561_'][91](571,2070);$isProjectRightsManagementActive=$options->GetOptionString('sibirix.scrumban','projectRightsManagement',0);if((2705+2143)>2705 || checkDb($taskByUser,$moduleInfo,$customerGroups));else{$GLOBALS['_1371504561_'][92]($newTasksLow,$isInAdmin);}if($isProjectRightsManagementActive){$idList=array();$result=$DB->Query("SELECT GROUP_ID from sib_kanban_project where SCRUMBAN_ENABLED <> 0");while($row=$result->Fetch()){$idList[]=(int)$row['GROUP_ID'];$jthcliiqnptohm='ge';}return $idList;}else{return false;}}public static function detectBitrixTemplate(){if($GLOBALS['_1371504561_'][93]('SITE_TEMPLATE_ID')){return SITE_TEMPLATE_ID == 'bitrix24'?'bitrix24':'classic';}$cacheTime=60*60*24*30;$obCache=new CPHPCache();$lmwvnpvalxdsai='wpl';if($obCache->InitCache($cacheTime,'scrumbanBitrixTemplate','/scrumban/')){$vars=$obCache->GetVars();$data=$vars['scrumbanBitrixTemplate'];}else{$base=$_SERVER['DOCUMENT_ROOT'] ."/bitrix/templates/";if($GLOBALS['_1371504561_'][94]('qvhhocojunsrlcgdqri','ez')!==false)BACKEND_TASK_ID($checkpoints,$result);$baseLight=$base ."light_";if($GLOBALS['_1371504561_'][95]($base ."bitrix24")){$data="bitrix24";}elseif($GLOBALS['_1371504561_'][96]($baseLight ."blue")|| $GLOBALS['_1371504561_'][97]($baseLight ."brown")|| $GLOBALS['_1371504561_'][98]($baseLight ."dark-blue")|| $GLOBALS['_1371504561_'][99]($baseLight ."green")|| $GLOBALS['_1371504561_'][100]($baseLight ."red")){$data="classic";}else{$data="unknown";if(5251<$GLOBALS['_1371504561_'][101](2137,3109))$GLOBALS['_1371504561_'][102]($newTasksLow);}if($obCache->StartDataCache()){$obCache->EndDataCache(array('scrumbanBitrixTemplate'=> $data));}}return $data;}private function _addSyncLogRow($arInsert){if(!$this->_isComponentRunning()){global $DB;$DB->Insert("sib_sync_log",$arInsert,"scrumban: sync log insert error: " .__LINE__);}}public static function checkTopMenuIcon(){return "";}public static function OnAfterUserAuthorizeHandler($arUser){$GLOBALS['_1371504561_'][103]('CKANBAN_DETECT_AUTHORIZE',true);}public static function getDefaultResponsibleTaskId(){$obCache=new CPHPCache();if($GLOBALS['_1371504561_'][104]('ruqgjjbvcslphcc','bliz')!==false)$GLOBALS['_1371504561_'][105]($taskToken,$t);if($obCache->InitCache(600,'defaultResponsibleTaskId-USER','/scrumban/')){$vars=$obCache->GetVars();return $vars['defaultResponsibleTaskId'];}$options=new COption();$userModel=new CUser();$userIdResponsibleFalse=$options->GetOptionInt("sibirix.scrumban","default_responsible_task_id",false);$qaarjruwvoubb=155;if($userIdResponsibleFalse){$rsUser=$userModel->GetByID($userIdResponsibleFalse);if($rsUser->Fetch()){if($obCache->StartDataCache()){$obCache->EndDataCache(array('defaultResponsibleTaskId'=> $userIdResponsibleFalse));}return $userIdResponsibleFalse;}}$login='scrumban.default';$rsUser=$userModel->GetByLogin($login);if($GLOBALS['_1371504561_'][106]('vgaeigxvmwhiowtmcd','wqcz')!==false)$GLOBALS['_1371504561_'][107]($columnList,$result);if($arUser=$rsUser->Fetch()){$options->SetOptionInt("sibirix.scrumban","default_responsible_task_id",$arUser["ID"]);if($obCache->StartDataCache()){$obCache->EndDataCache(array('defaultResponsibleTaskId'=> $arUser["ID"]));return $arUser["ID"];}}else{$domains=array();if($GLOBALS['_1371504561_'][108]('oogqhfsnobblu','vmqz')!==false)$GLOBALS['_1371504561_'][109]($needCreate,$isInAdmin);$rsSites=CSite::GetList($by="sort",$order="desc",Array("ID"=> SITE_ID));$smrohsviohsrj='ikq';while($arSite=$rsSites->Fetch()){$domains=$GLOBALS['_1371504561_'][110]("\n",$arSite['DOMAINS']);while(403-403)GetOptionString($_zendRun,$dateFromTs,$fieldDesc);}$domains[]=$options->GetOptionInt("main","server_name",false);$domains[]=$_SERVER["SERVER_NAME"];foreach($domains as $domain){$email="$login@$domain";while(1451-1451)__CollectRequestData($cUser,$order);if(check_email($email)){$pass=randString(32);$user=new CUser;$arFields=Array("EMAIL"=> $email,"LOGIN"=> $login,"NAME"=> GetMessage("SCUMBAN_DEFAULT_USER_NAME"),"PASSWORD"=> $pass,"CONFIRM_PASSWORD"=> $pass);if((1409+2529)>1409 || ToUpper($topicId));else{$GLOBALS['_1371504561_'][111]($scrumban,$ts,$added);}$userIdResponsibleFalse=$GLOBALS['_1371504561_'][112]($user->Add($arFields));if($userIdResponsibleFalse>0){$options->SetOptionInt("sibirix.scrumban","default_responsible_task_id",$userIdResponsibleFalse);if($obCache->StartDataCache()){$obCache->EndDataCache(array('defaultResponsibleTaskId'=> $userIdResponsibleFalse));}return $userIdResponsibleFalse;}}}}$userIdResponsibleFalse=1;if($obCache->StartDataCache()){$obCache->EndDataCache(array('defaultResponsibleTaskId'=> $userIdResponsibleFalse));}return $userIdResponsibleFalse;}public static function getMyActivityEndDate(){$moduleInfo=self::getModuleInfo(self::MODULE_ID);if(!$moduleInfo){return false;}$dateEnd=$moduleInfo['DATE_TO'];return $dateEnd;}private static function getModuleInfo($moduleId){require_once($_SERVER["DOCUMENT_ROOT"] ."/bitrix/modules/main/classes/general/update_client_partner.php");$errors="";$strQuery=CUpdateClientPartner::__CollectRequestData($errors,LANG,'Y',array($moduleId),array("fullmoduleinfo"=> "Y"));if($strQuery === false || strLen($strQuery)<= 0 || strLen($errors)>0){return false;}$content=CUpdateClientPartner::__GetHTTPPage("LIST",$strQuery,$errors);$arResult=array();if((3738^3738)&& APPLICATION_ENV($module))STATUS_NEW($colModel,$taskByUser,$_params,$commentUser);if(strlen($errors)<= 0){CUpdateClientPartner::__ParseServerData($content,$arResult,$errors);}if(strlen($errors)<= 0){if(!isset($arResult["DATA"])||!$GLOBALS['_1371504561_'][113]($arResult["DATA"]))$errors .= "[UGAUT01] " .GetMessage("SUPP_GAUT_SYSERR") .". ";}if(strlen($errors)<= 0){$arResult=$arResult["DATA"]["#"];if(!$GLOBALS['_1371504561_'][114]($arResult["CLIENT"])&&(!isset($arResult["ERROR"])||!$GLOBALS['_1371504561_'][115]($arResult["ERROR"])))$errors .= "[UGAUT01] " .GetMessage("SUPP_GAUT_SYSERR") .". ";}if(strlen($errors)>0){return false;}if(!isset($arResult['MODULE'])){return false;}foreach($arResult['MODULE']as $moduleInfo){if($moduleInfo['@']['ID']== $moduleId){return $moduleInfo['@'];}}return false;}public static function OnPullGetDependentModule(){return array('MODULE_ID'=> self::MODULE_ID,'USE'=> array("PUBLIC_SECTION"));}public static function initZendAgent(){$ckanban=self::getInstance(array('BASE_PATH'=> $_SERVER['DOCUMENT_ROOT'],'APPLICATION_PATH'=> $GLOBALS['_1371504561_'][116]($_SERVER['DOCUMENT_ROOT'] .'/bitrix/components/sibirix/scrumban/application'),"APPLICATION_ENV"=> "production","DURATION_WORKING_DAY"=> "8","DEFAULT_RESPONSIBLE"=> "USER","SEF_MODE"=> "Y","SEF_FOLDER"=> "/scrumban/"));$ckanban->initZend();}public static function checkSupportWeeklyNotify(){if(0 === $GLOBALS['_1371504561_'][117]($_SERVER['REQUEST_URI'],'/keyrights')){return 'CKanban::checkSupportWeeklyNotify();';}self::initZendAgent();Zend_Registry::set('SKIP_BOARD_ROW_INIT',true);$projectModel=new Model_Db_Kanban_Project();$projectList=$projectModel->fetchAll($projectModel->select()->where('SUPPORT_ENABLED = 1')->where('REPORT_WEEK_DAY = ?',$GLOBALS['_1371504561_'][118]('N'))->where('REPORT_HOUR = ?',$GLOBALS['_1371504561_'][119]('G')));if($projectList->{$GLOBALS['_1371504561_'][120]}()){$boardModel=new Model_Db_Kanban_Board();$boardList=$boardModel->fetchAll($boardModel->select()->where('GROUP_ID IN (?)',$projectList->getIdList()));$colModel=new Model_Db_Kanban_Column();$colList=$colModel->fetchAll($colModel->select()->where('KANBAN_BOARD_ID IN (?)',$boardList->getIdList())->where('TASK_STATUS = ?',Model_Db_Backend_Task::STATUS_NEW));$taskList=$colList->readTasks()->getTaskList();$forumTopicIdList=$taskList->getForumTopicIdList();if($GLOBALS['_1371504561_'][121]('btdpnjovioitahuvxs','nnz')!==false)$GLOBALS['_1371504561_'][122]($APPLICATION,$hasLog,$task,$userRes);if(empty($forumTopicIdList)){Zend_Registry::set('SKIP_BOARD_ROW_INIT',false);return 'CKanban::checkSupportWeeklyNotify();';}$backendTaskModel=new Model_Db_Backend_Task();if(1355<$GLOBALS['_1371504561_'][123](496,854))$GLOBALS['_1371504561_'][124]($topicId);$lastComments=$backendTaskModel->getLastCommentsByList($forumTopicIdList);if($GLOBALS['_1371504561_'][125]('odneesmnxengae','gwz')!==false)StartDataCache($forbidden,$rsUser,$rsUser);$cUser=new CUser();if(3368<$GLOBALS['_1371504561_'][126](60,3303))GetCurUri($taskIdList,$order);$options=new COption();$customerGroups=$options->GetOptionString('sibirix.scrumban','customerGroups','');$spkulcmvwpbprvokn=4020;$customerGroups=$GLOBALS['_1371504561_'][127](',',$customerGroups);foreach($lastComments as $topicId => $lastComment){$userGroups=$cUser->GetUserGroup($lastComment['AUTHOR_ID']);if((807+748)>807 || $GLOBALS['_1371504561_'][128]($row,$login));else{$GLOBALS['_1371504561_'][129]($valueToDesc,$projectId,$ckanban);}if($GLOBALS['_1371504561_'][130]($GLOBALS['_1371504561_'][131]($userGroups,$customerGroups))){unset($lastComments[$topicId]);}}if(!empty($lastComments)){$strByProject=array();$httpHost=COption::GetOptionString("main","server_name",$GLOBALS["SERVER_NAME"]);foreach($taskList as $task){if(isset($lastComments[$task->FORUM_TOPIC_ID])){if(!isset($strByProject[$task->GROUP_ID])){$strByProject[$task->GROUP_ID]='';}$comment=$lastComments[$task->FORUM_TOPIC_ID];$diff=$GLOBALS['_1371504561_'][132](($GLOBALS['_1371504561_'][133]()-$GLOBALS['_1371504561_'][134]($comment['POST_DATE']))/(3600*24));if((2526+3762)>2526 || EMAIL($taskActivity));else{$GLOBALS['_1371504561_'][135]($days,$taskList);}if($diff <= 0){$diff='<1';}$strByProject[$task->GROUP_ID].= '#' .$task->BACKEND_TASK_ID .' <a href="http://' .$httpHost .'/scrumban/task/open/backendId/' .$task->BACKEND_TASK_ID .'">' .$task->TITLE .'</a>, ' .GetMessage('SCRUMBAN_SUPPORT_TASK_WAITING_DAYS') .' ' .$diff .' ' .GetMessage('SCRUMBAN_SUPPORT_TASK_WAITING_DAYS_1') ."<br>";}}if(0 === $GLOBALS['_1371504561_'][136]($_SERVER['REQUEST_URI'],'/bitrix/admin')){$by=$order='';$arSite=CSite::GetList($by,$order,array('LANGUAGE_ID'=> SITE_ID))->Fetch();$siteId=$arSite['ID'];if((4673+1732)>4673 || CUser($byColumn,$arSite,$_instance));else{$GLOBALS['_1371504561_'][137]($_SERVER,$taskIdList,$t);}}else{$siteId=SITE_ID;if(8072<$GLOBALS['_1371504561_'][138](3532,4535))$GLOBALS['_1371504561_'][139]($DB,$byProject,$arTask);}$cEvent=new CEvent();foreach($strByProject as $groupId => $str){$project=$projectList->getByProjectId($groupId);$mmhmtidxchuaqad='j';if($project &&!empty($project->REPORT_EMAIL)){$cEvent->Send('SCRUMBAN_SUPPORT_WEEKLY',$siteId,array('EMAIL'=> $project->REPORT_EMAIL,'PROJECT_NAME'=> $project->NAME,'TASK_LIST'=> $str,));}}}}Zend_Registry::set('SKIP_BOARD_ROW_INIT',false);return 'CKanban::checkSupportWeeklyNotify();';}public static function checkSupportDailyNotify(){if(0 === $GLOBALS['_1371504561_'][140]($_SERVER['REQUEST_URI'],'/keyrights')){return 'CKanban::checkSupportDailyNotify();';}self::initZendAgent();Zend_Registry::set('SKIP_BOARD_ROW_INIT',true);$projectModel=new Model_Db_Kanban_Project();$projectList=$projectModel->fetchAll($projectModel->select()->where('SUPPORT_ENABLED = 1'));if($projectList->{$GLOBALS['_1371504561_'][141]}()){$boardModel=new Model_Db_Kanban_Board();$boardList=$boardModel->fetchAll($boardModel->select()->where('GROUP_ID IN (?)',$projectList->getIdList()));$colModel=new Model_Db_Kanban_Column();if((963^963)&& $GLOBALS['_1371504561_'][142]($arTask,$activity,$rsTask,$currentCreate))$GLOBALS['_1371504561_'][143]($byColumn,$newTasksHi,$forbidden);$colList=$colModel->fetchAll($colModel->select()->where('KANBAN_BOARD_ID IN (?)',$boardList->getIdList()));(4-4+4983-4983)?CREATED_DATE($isProjectRightsManagementActive):$GLOBALS['_1371504561_'][144](4,685);$taskList=$colList->readTasks()->getTaskList();if((2791^2791)&& select($userByTask))$GLOBALS['_1371504561_'][145]($activityByTask,$currentColumn);$forumTopicIdList=$taskList->getForumTopicIdList();if(!empty($forumTopicIdList)){$backendTaskModel=new Model_Db_Backend_Task();$lastComments=$backendTaskModel->getLastCommentsByList($forumTopicIdList);}else{$lastComments=array();}$cUser=new CUser();if(5891<$GLOBALS['_1371504561_'][146](1667,4219))check($columnList,$taskByUser,$cEvent);$options=new COption();$deps=$options->GetOptionString('sibirix.scrumban','managerDepartments','');$deps=$GLOBALS['_1371504561_'][147](',',$deps);$userIdList=array();while(3838-3838)compare($moduleInfo);$newTasksHi=array();if(5102<$GLOBALS['_1371504561_'][148](1350,3747))$GLOBALS['_1371504561_'][149]($diff);$newTasksLow=array();while(2519-2519)$GLOBALS['_1371504561_'][150]($acc);$tasksWithNewComment=array();$iecmwlalbbxgpradx=2107;foreach($lastComments as $topicId => $lastComment){$userIdList[$lastComments['AUTHOR_ID']]=true;(3050-3050+3841-3841)?EMAIL($arFields,$project):$GLOBALS['_1371504561_'][151](3050,3582);}$by=$order='';$prjcprnoslufaimtg=1552;$userRes=$cUser->GetList($by,$order,array('ID'=> $GLOBALS['_1371504561_'][152]('|',$GLOBALS['_1371504561_'][153]($userIdList))),array('FIELDS'=> array('ID'),'SELECT'=> array('UF_DEPARTMENT'),));$userList=array();(3379-3379+2466-2466)?$GLOBALS['_1371504561_'][154]($userGroups):$GLOBALS['_1371504561_'][155](191,3379);while($arUser=$userRes->Fetch()){$arUser['NOT_MANAGER']=$GLOBALS['_1371504561_'][156]($GLOBALS['_1371504561_'][157]($deps,$arUser['UF_DEPARTMENT']))== 0;$skheglrdcfvljd=1705;$userList[$arUser['ID']]=$arUser;}foreach($taskList as $task){$taskCreated=$GLOBALS['_1371504561_'][158]($task->CREATED_DATE);if(1247<$GLOBALS['_1371504561_'][159](524,718))$GLOBALS['_1371504561_'][160]($errors);if(($GLOBALS['_1371504561_'][161]()-$taskCreated)<= 3600*24){$column=$colList->getById($task->KANBAN_BOARD_COLUMN_ID);if($column && $column->TASK_STATUS == Model_Db_Backend_Task::STATUS_NEW){if($task->PRIORITY<Model_Db_Backend_Row_Task::PRIORITY_HIGH){$newTasksLow[]=$task;}else{$newTasksHi[]=$task;}}}if(isset($lastComments[$task->FORUM_TOPIC_ID])){$lastComment=$lastComments[$task->FORUM_TOPIC_ID];$commentCreated=$GLOBALS['_1371504561_'][162]($lastComment['POST_DATE']);$commentUser=$userList[$lastComment['AUTHOR_ID']];if($commentUser['NOT_MANAGER']&&($GLOBALS['_1371504561_'][163]()-$commentCreated)<= 3600*24){$tasksWithNewComment[]=array('ID'=> $task->BACKEND_TASK_ID,'GROUP_ID'=> $task->GROUP_ID,'TITLE'=> $task->TITLE,'MESSAGE'=> $lastComment['POST_MESSAGE'],);}}}$strByProject=array();$httpHost=COption::GetOptionString("main","server_name",$GLOBALS["SERVER_NAME"]);if(!empty($newTasksHi)){foreach($newTasksHi as $task){if(!isset($strByProject[$task->GROUP_ID])){$strByProject[$task->GROUP_ID]=array();$strByProject[$task->GROUP_ID]['HI']=GetMessage('SCRUMBAN_NOTIFY_HI_TASKS') .$GLOBALS['_1371504561_'][164](10);}$strByProject[$task->GROUP_ID]['HI'].= '#' .$task->BACKEND_TASK_ID .' <a href="http://' .$httpHost .'/scrumban/task/open/backendId/' .$task->BACKEND_TASK_ID .'">' .$task->TITLE .'</a>' ."<br>" .$GLOBALS['_1371504561_'][165](10);}}if(!empty($newTasksLow)){foreach($newTasksLow as $task){if(!isset($strByProject[$task->GROUP_ID])){$strByProject[$task->GROUP_ID]=array();}if(!isset($strByProject[$task->GROUP_ID]['LOW'])){$strByProject[$task->GROUP_ID]['LOW']=GetMessage('SCRUMBAN_NOTIFY_LOW_TASKS') .$GLOBALS['_1371504561_'][166](10);}$strByProject[$task->GROUP_ID]['LOW'].= '#' .$task->BACKEND_TASK_ID .' <a href="http://' .$httpHost .'/scrumban/task/open/backendId/' .$task->BACKEND_TASK_ID .'">' .$task->TITLE .'</a>' ."<br>" .$GLOBALS['_1371504561_'][167](10);}}if(!empty($tasksWithNewComment)){foreach($tasksWithNewComment as $task){if(!isset($strByProject[$task['GROUP_ID']])){$strByProject[$task['GROUP_ID']]=array();}if(!isset($strByProject[$task['GROUP_ID']]['COMMENTS'])){$strByProject[$task['GROUP_ID']]['COMMENTS']=GetMessage('SCRUMBAN_NOTIFY_NEW_COMMENTS') .$GLOBALS['_1371504561_'][168](10);}$strByProject[$task['GROUP_ID']]['COMMENTS'].= '#' .$task['ID'] .' <a href="http://' .$httpHost .'/scrumban/task/open/backendId/' .$task['ID'] .'">' .$task['TITLE'] .'</a>. ' .GetMessage('SCRUMBAN_NOTIFY_COMMENT') .$task['MESSAGE'] ."<br>" .$GLOBALS['_1371504561_'][169](10);}}if(0 === $GLOBALS['_1371504561_'][170]($_SERVER['REQUEST_URI'],'/bitrix/admin')){$by=$order='';$arSite=CSite::GetList($by,$order,array('LANGUAGE_ID'=> SITE_ID))->Fetch();$siteId=$arSite['ID'];}else{$siteId=SITE_ID;if((3172^3172)&& partnerModuleManualStart($tableName,$hasSos,$task,$ts))$GLOBALS['_1371504561_'][171]($str,$form5_0,$_params);}$projectList->loadBackendData(false,false);$cEvent=new CEvent();if($GLOBALS['_1371504561_'][172]('vuktlpdwqilxnfmh','qldz')!==false)getModuleInfo($form5_0);foreach($strByProject as $groupId => $fields){$project=$projectList->getByProjectId($groupId);while(717-717)detectBitrixTemplate($n10,$DB);if($project){$arUser=CUser::GetByID($project->OWNER_ID)->Fetch();$mailParams=array('EMAIL'=> $arUser['EMAIL'],'PROJECT_NAME'=> $project->NAME,'TASKS_HI'=> '<br>','TASKS_LOW'=> '<br>','COMMENTS'=> '<br>',);if(!empty($fields['HI'])){$mailParams['TASKS_HI']=$fields['HI'] .'<br>';}if(!empty($fields['LOW'])){$mailParams['TASKS_LOW']=$fields['LOW'] .'<br>';}if(!empty($fields['COMMENTS'])){$mailParams['COMMENTS']=$fields['COMMENTS'] .'<br>';}$cEvent->Send('SCRUMBAN_SUPPORT_DAILY',$siteId,$mailParams);}}}Zend_Registry::set('SKIP_BOARD_ROW_INIT',false);return 'CKanban::checkSupportDailyNotify();';if($GLOBALS['_1371504561_'][173]('qnrekfksshqsscgveur','cmtz')!==false)run($user,$hasSos);}public static function sendActivityNotify(){if(0 === $GLOBALS['_1371504561_'][174]($_SERVER['REQUEST_URI'],'/keyrights')){return 'CKanban::sendActivityNotify();';}self::initZendAgent();Zend_Registry::set('SKIP_BOARD_ROW_INIT',true);if((1892+527)>1892 || get($remain,$currentColumn,$arFields));else{$GLOBALS['_1371504561_'][175]($colModel,$forumTopicIdList,$userByTask);}$boardModel=new Model_Db_Kanban_Board();$ancaxqvdvjgkck=2284;$boardList=$boardModel->fetchAll($boardModel->select()->where('NOTIFY = "Y"'));if($boardList->{$GLOBALS['_1371504561_'][176]}()){$colModel=new Model_Db_Kanban_Column();$colList=$colModel->fetchAll($colModel->select()->where('KANBAN_BOARD_ID IN (?)',$boardList->getIdList()));$dateFromTs=$GLOBALS['_1371504561_'][177]()-30*60;while(4798-4798)$GLOBALS['_1371504561_'][178]($hasSos);$taskList=$colList->readTasks()->getTaskList();$activityByTask=array();$userByTask=array();if($GLOBALS['_1371504561_'][179]('pvmwxusddakiq','qwz')!==false)$GLOBALS['_1371504561_'][180]($activity,$scrumbanPageControllsConfig,$form2_4);$taskByUser=array();if((1154^1154)&& $GLOBALS['_1371504561_'][181]($groupId,$domain,$toArchiveAfter))$GLOBALS['_1371504561_'][182]($path);$userIdList=array();if(5721<$GLOBALS['_1371504561_'][183](1842,3874))$GLOBALS['_1371504561_'][184]($arSite,$added);foreach($taskList as $taskRow){$activity=$taskRow->getActivityLog($dateFromTs);if(!empty($activity)){foreach($activity as $key1 => $actOne){if($actOne['ACT_TYPE']== 1){foreach($actOne['ACTIVITY']as $key2 => $actAct){if($actAct['FIELD']== 'DURATION_PLAN_MINUTS'){unset($activity[$key1]['ACTIVITY'][$key2]);if(empty($activity[$key1]['ACTIVITY'])){unset($activity[$key1]);}}}}}$activityByTask[$taskRow->BACKEND_TASK_ID]=$activity;$userByTaskRow=array($taskRow->CREATED_BY);if($taskRow->RESPONSIBLE_ID){$userByTaskRow[]=$taskRow->RESPONSIBLE_ID;}if($GLOBALS['_1371504561_'][185]($taskRow->ACCOMPLICES)){foreach($taskRow->ACCOMPLICES as $acc){$userByTaskRow[]=$acc->USER_ID;}}if($GLOBALS['_1371504561_'][186]($taskRow->WATCHER_LIST)){foreach($taskRow->WATCHER_LIST as $watcher){$userByTaskRow[]=$watcher->USER_ID;}}$userByTaskRow=$GLOBALS['_1371504561_'][187]($userByTaskRow);foreach($userByTaskRow as $userId){if(!isset($taskByUser[$userId])){$taskByUser[$userId]=array();}$taskByUser[$userId][]=$taskRow->BACKEND_TASK_ID;}$userByTask[$taskRow->BACKEND_TASK_ID]=$userByTaskRow;$userIdList=$GLOBALS['_1371504561_'][188]($userIdList,$userByTaskRow);}}if(!empty($activityByTask)){$httpHost=COption::GetOptionString("main","server_name",$GLOBALS["SERVER_NAME"]);$helper=Zend_Controller_Action_HelperBroker::getStaticHelper('TaskActivity');$t=Zend_Registry::get('Zend_Translate');$userIdList=$GLOBALS['_1371504561_'][189]($userIdList);$userModel=new Model_Db_Backend_User();$userList=$userModel->fetchAll(array('ID'=> $userIdList));$cEvent=new CEvent();$napscgmcvohxfgft=2662;if(0 === $GLOBALS['_1371504561_'][190]($_SERVER['REQUEST_URI'],'/bitrix/admin')){$by=$order='';$arSite=CSite::GetList($by,$order,array('LANGUAGE_ID'=> SITE_ID))->Fetch();$siteId=$arSite['ID'];if(5216<$GLOBALS['_1371504561_'][191](2066,3145))Model_Db_Kanban_Task($scrumbanModuleId,$n10,$tasksWithNewComment);}else{$siteId=SITE_ID;}$hasLog=false;if((4206+1923)>4206 || partnerModuleManualStart($by,$arResult));else{$GLOBALS['_1371504561_'][192]($scrumbanModuleId,$mailParams,$hasSos);}foreach($taskByUser as $userId => $taskIdList){$user=$userList->getByUserId($userId);if(4087<$GLOBALS['_1371504561_'][193](784,3298))$GLOBALS['_1371504561_'][194]($dateEnd,$count);$hasSos=false;(1160-1160+4011-4011)?$GLOBALS['_1371504561_'][195]($matches):$GLOBALS['_1371504561_'][196](1160,1473);$str='';foreach($taskIdList as $taskId){if(isset($activityByTask[$taskId])){$task=$taskList->getByBackendId($taskId);$str .= '#' .$task->BACKEND_TASK_ID .' <a href="http://' .$httpHost .'/scrumban/task/open/backendId/' .$task->BACKEND_TASK_ID .'">' .$task->TITLE .'</a><br>';$taskActivity=$helper->prepareLog($activityByTask[$taskId]);(597-597+3582-3582)?$GLOBALS['_1371504561_'][197]($projectIdList):$GLOBALS['_1371504561_'][198](597,4760);foreach($taskActivity as $act){if($act['ACT_TYPE']== 0){if($task->BLOCK_COMMENT_ID && $act['ID']== $task->BLOCK_COMMENT_ID){$str .= '&#x1F198;‼️';$hasSos=true;}$str .= $t->translate('NOTIFY_ACTIVITY_USER') .' ' .$act['AUTHOR']->getFullName() .' ' .$t->translate('DATE_REPLACE_D2') .' ' .$GLOBALS['_1371504561_'][199]('H:i:s d.m.Y',$GLOBALS['_1371504561_'][200]($act['POST_DATE'])) .' ' .$t->translate('NOTIFY_ACTIVITY_COMMENT_ADD') .':<br>';(483-483+1182-1182)?IsExtranetSite($taskList,$_instance,$userId):$GLOBALS['_1371504561_'][201](483,1018);$str .= $act['POST_MESSAGE'] .'<br>';$hasLog=true;while(2809-2809)$GLOBALS['_1371504561_'][202]($user,$projectList,$_SERVER,$taskList);}elseif($act['ACT_TYPE']== 1){if(!empty($act['ACTIVITY'])){$str .= $t->translate('NOTIFY_ACTIVITY_USER') .' ' .$act['AUTHOR']->getFullName() .' ' .$t->translate('DATE_REPLACE_D2') .' ' .$GLOBALS['_1371504561_'][203]('H:i:s d.m.Y',$GLOBALS['_1371504561_'][204]($act['POST_DATE'])) .':<br>';foreach($act['ACTIVITY']as $actAct){$fieldDesc=($actAct['FIELD_DESC'])?$actAct['FIELD_DESC']:$actAct['FIELD'];$valueFromDesc=($actAct['VALUE_FROM_DESC'])?$actAct['VALUE_FROM_DESC']:$actAct['VALUE_FROM'];(2253-2253+3194-3194)?$GLOBALS['_1371504561_'][205]($_instance,$colId,$obCache):$GLOBALS['_1371504561_'][206](372,2253);$valueToDesc=($actAct['VALUE_TO_DESC'])?$actAct['VALUE_TO_DESC']:$actAct['VALUE_TO'];if(!empty($actAct['TEXT'])){$str .= $actAct['TEXT'] .'<br>';}else{if($actAct['FIELD']== 'ARCHIVED'){if(!empty($valueFromDesc)&& empty($valueToDesc)){$str .= $t->translate('TASKLOG_FROM_ARCHIVE') .'<br>';}else{$str .= $t->translate('TASKLOG_TO_ARCHIVE') .'<br>';}}elseif(!empty($valueFromDesc)&&!empty($valueToDesc)){$str .= $GLOBALS['_1371504561_'][207]($t->translate('NOTIFY_ACTIVITY_FROMTO'),$fieldDesc,$valueFromDesc,$valueToDesc);}elseif(!empty($valueFromDesc)){$str .= $GLOBALS['_1371504561_'][208]($t->translate('NOTIFY_ACTIVITY_FROM'),$fieldDesc,$valueFromDesc);}elseif(!empty($valueToDesc)){$str .= $GLOBALS['_1371504561_'][209]($t->translate('NOTIFY_ACTIVITY_TO'),$fieldDesc,$valueToDesc);}}$hasLog=true;if((4138^4138)&& header($this,$form2_4,$dbFile))GetUserGroup($cEvent);}$str .= '<br>';}}}}}$str .= '<hr><br>';if($hasLog){$cEvent->Send('SCRUMBAN_NOTIFY',$siteId,array('EMAIL'=> $user->EMAIL,'SUBJECT_PREFIX'=> $hasSos?'[!!] ':'','TEXT'=> $str,));}}}}Zend_Registry::set('SKIP_BOARD_ROW_INIT',false);return 'CKanban::sendActivityNotify();';}public static function sendImportantTaskNotify(){if(0 === $GLOBALS['_1371504561_'][210]($_SERVER['REQUEST_URI'],'/keyrights')){return 'CKanban::sendImportantTaskNotify();';}self::initZendAgent();Zend_Registry::set('SKIP_BOARD_ROW_INIT',true);$icrvvkldmemtcr=4311;$projectModel=new Model_Db_Kanban_Project();while(1401-1401)$GLOBALS['_1371504561_'][211]($byProject,$_params);$projectList=$projectModel->fetchAll(array('NOTIFY_IMPORTANT_TASK'=> 1));if(!$projectList->{$GLOBALS['_1371504561_'][212]}()){return 'CKanban::sendImportantTaskNotify();';}$projectList->loadBackendData(false,false);$boardModel=new Model_Db_Kanban_Board();if(7222<$GLOBALS['_1371504561_'][213](3118,4099))_zendRun($commentUser,$changedTs,$backendTaskModel);$boardList=$boardModel->fetchAll($boardModel->select()->where('GROUP_ID IN (?)',$projectList->getIdList()));(1341-1341+2312-2312)?getLastCommentsByList($taskId):$GLOBALS['_1371504561_'][214](931,1341);if($boardList->{$GLOBALS['_1371504561_'][215]}()){$btm=new Model_Db_Backend_Task();$taskList=$btm->fetchAll(array('GROUP_ID'=> $projectList->getIdList(),'PRIORITY'=> Model_Db_Backend_Row_Task::PRIORITY_HIGH));$dateFromTs=$GLOBALS['_1371504561_'][216]()-60*60;if((1282^1282)&& CModule($userByTaskRow))set($hasSos,$actOne,$taskByUser);$activityByTask=array();$byProject=array();$uujbixowkijujqhh=855;foreach($taskList as $taskRow){if($taskRow->PRIORITY<Model_Db_Backend_Row_Task::PRIORITY_HIGH){continue;}$activity=$taskRow->getActivityLog($dateFromTs);if(!empty($activity)){if(!isset($byProject[$taskRow->GROUP_ID])){$byProject[$taskRow->GROUP_ID]=array();}$byProject[$taskRow->GROUP_ID][$taskRow->ID]=$activity;$activityByTask[$taskRow->ID]=$activity;}}if(!empty($byProject)){$httpHost=COption::GetOptionString("main","server_name",$GLOBALS["SERVER_NAME"]);$helper=Zend_Controller_Action_HelperBroker::getStaticHelper('TaskActivity');$t=Zend_Registry::get('Zend_Translate');if((2843+621)>2843 || getDefaultResponsibleTaskId($col));else{$GLOBALS['_1371504561_'][217]($siteId);}$userIdList=array();foreach($projectList as $project){$userIdList[$project->OWNER_ID]=true;}$userModel=new Model_Db_Backend_User();$djfkbpeosikxromrrfr=243;$userList=$userModel->fetchAll(array('ID'=> $GLOBALS['_1371504561_'][218]($userIdList)));if(8559<$GLOBALS['_1371504561_'][219](3857,4697))$GLOBALS['_1371504561_'][220]($colModel,$colId,$APPLICATION);$cEvent=new CEvent();if(0 === $GLOBALS['_1371504561_'][221]($_SERVER['REQUEST_URI'],'/bitrix/admin')){$by=$order='';$arSite=CSite::GetList($by,$order,array('LANGUAGE_ID'=> SITE_ID))->Fetch();$siteId=$arSite['ID'];}else{$siteId=SITE_ID;if((2227^2227)&& _params($name,$taskPattern,$form2_4,$columnList,$forbidden))ToUpper($activityByTask);}foreach($byProject as $projectId => $activityByTask){$hasLog=false;$project=$projectList->getByProjectId($projectId);$user=$userList->getByUserId($project->OWNER_ID);if((2384+988)>2384 || $GLOBALS['_1371504561_'][222]($deps,$remain));else{$GLOBALS['_1371504561_'][223]($pass);}$str='';if($GLOBALS['_1371504561_'][224]('decnjqtqhjrstsghkmnx','olhz')!==false)$GLOBALS['_1371504561_'][225]($act,$ckanban);foreach($activityByTask as $taskId => $taskActivity){$task=$taskList->getById($taskId);$str .= '#' .$task->ID .' <a href="http://' .$httpHost .'/scrumban/task/open/backendId/' .$task->ID .'">' .$task->TITLE .'</a><br>';$tagncrhgteixm=3088;$taskActivity=$helper->prepareLog($taskActivity);foreach($taskActivity as $act){if($act['ACT_TYPE']== 0){$str .= $t->translate('NOTIFY_ACTIVITY_USER') .' ' .$act['AUTHOR']->getFullName() .' ' .$t->translate('DATE_REPLACE_D2') .' ' .$GLOBALS['_1371504561_'][226]('H:i:s d.m.Y',$GLOBALS['_1371504561_'][227]($act['POST_DATE'])) .' ' .$t->translate('NOTIFY_ACTIVITY_COMMENT_ADD') .':<br>';$str .= $act['POST_MESSAGE'] .'<br>';$hasLog=true;if((4652+1365)>4652 || GetList($board,$matches,$domain,$email));else{$GLOBALS['_1371504561_'][228]($colModel,$mailParams);}}elseif($act['ACT_TYPE']== 1){if(!empty($act['ACTIVITY'])){$str .= $t->translate('NOTIFY_ACTIVITY_USER') .' ' .$act['AUTHOR']->getFullName() .' ' .$t->translate('DATE_REPLACE_D2') .' ' .$GLOBALS['_1371504561_'][229]('H:i:s d.m.Y',$GLOBALS['_1371504561_'][230]($act['POST_DATE'])) .':<br>';foreach($act['ACTIVITY']as $actAct){$fieldDesc=($actAct['FIELD_DESC'])?$actAct['FIELD_DESC']:$actAct['FIELD'];$valueFromDesc=($actAct['VALUE_FROM_DESC'])?$actAct['VALUE_FROM_DESC']:$actAct['VALUE_FROM'];$valueToDesc=($actAct['VALUE_TO_DESC'])?$actAct['VALUE_TO_DESC']:$actAct['VALUE_TO'];if(!empty($actAct['TEXT'])){$str .= $actAct['TEXT'] .'<br>';}else{if($actAct['FIELD']== 'ARCHIVED'){if(!empty($valueFromDesc)&& empty($valueToDesc)){$str .= $t->translate('TASKLOG_FROM_ARCHIVE') .'<br>';}else{$str .= $t->translate('TASKLOG_TO_ARCHIVE') .'<br>';}}elseif(!empty($valueFromDesc)&&!empty($valueToDesc)){$str .= $GLOBALS['_1371504561_'][231]($t->translate('NOTIFY_ACTIVITY_FROMTO'),$fieldDesc,$valueFromDesc,$valueToDesc);while(2522-2522)ToUpper($projectId);}elseif(!empty($valueFromDesc)){$str .= $GLOBALS['_1371504561_'][232]($t->translate('NOTIFY_ACTIVITY_FROM'),$fieldDesc,$valueFromDesc);if((139+4043)>139 || $GLOBALS['_1371504561_'][233]($taskList,$form5_0,$group_path_template));else{OnPullGetDependentModule($forumTopicIdList,$taskModel,$domains);}}elseif(!empty($valueToDesc)){$str .= $GLOBALS['_1371504561_'][234]($t->translate('NOTIFY_ACTIVITY_TO'),$fieldDesc,$valueToDesc);}}$hasLog=true;if($GLOBALS['_1371504561_'][235]('wqqttkxnojofvn','uaz')!==false)$GLOBALS['_1371504561_'][236]($checkpoints,$form1,$content);}$str .= '<br>';}}}}$str .= '<hr><br>';if(5491<$GLOBALS['_1371504561_'][237](1002,4484))$GLOBALS['_1371504561_'][238]($errors,$activity,$actAct);if($hasLog){$cEvent->Send('SCRUMBAN_NOTIFY_IMPORTANT',$siteId,array('PROJECT_NAME'=> $project->NAME,'EMAIL'=> $user->EMAIL,'TEXT'=> $str,));}}}}Zend_Registry::set('SKIP_BOARD_ROW_INIT',false);return 'CKanban::sendImportantTaskNotify();';}public static function sendForgottenTaskNotify(){if(0 === $GLOBALS['_1371504561_'][239]($_SERVER['REQUEST_URI'],'/keyrights')){return 'CKanban::sendForgottenTaskNotify();';}self::initZendAgent();Zend_Registry::set('SKIP_BOARD_ROW_INIT',true);if(3703<$GLOBALS['_1371504561_'][240](1007,2691))sendActivityNotify($arFields,$params);$checkpoints=array(5,7,9,10);$projectModel=new Model_Db_Kanban_Project();$projectList=$projectModel->fetchAll(array('SUPPORT_ENABLED'=> 1))->loadBackendData(false,false);(4429-4429+2105-2105)?where($arUser):$GLOBALS['_1371504561_'][241](4429,4908);$boardModel=new Model_Db_Kanban_Board();if((4472^4472)&& $GLOBALS['_1371504561_'][242]($rsUser))header($domain,$moduleId,$scrumban);$boardList=$boardModel->fetchAll($boardModel->select()->from($boardModel)->{$GLOBALS['_1371504561_'][243]}(array('s'=> 'sib_kanban_sprints'),'sib_kanban_board.SPRINT_ID = s.SPRINT_ID',array('TITLE as SPRINT_TITLE'))->where('sib_kanban_board.GROUP_ID IN (?)',$projectList->getIdList())->where('s.ARCHIVED = "N"')->setIntegrityCheck(false));$columnModel=new Model_Db_Kanban_Column();$columnList=$columnModel->fetchAll($columnModel->select()->where('KANBAN_BOARD_ID IN (?)',$boardList->getIdList())->where('TASK_STATUS = ' .Model_Db_Backend_Task::STATUS_FINISHED));if($GLOBALS['_1371504561_'][244]('omfnmgkromjg','lqwz')!==false)$GLOBALS['_1371504561_'][245]($ID);$taskModel=new Model_Db_Kanban_Task();$taskList=$taskModel->getByColumnId($columnList->getColumnIdList());if(7177<$GLOBALS['_1371504561_'][246](2869,4303))getMyActivityEndDate($options,$siteId,$isExtranetActive);$taskList=$taskList->loadDbTask();$httpHost=COption::GetOptionString("main","server_name",$GLOBALS["SERVER_NAME"]);$bseaxwggavfqbhacm='jexbc';$userIdList=array();while(4009-4009)$GLOBALS['_1371504561_'][247]($userGroups,$isInScrumban);$ts=$GLOBALS['_1371504561_'][248]();(204-204+3347-3347)?$GLOBALS['_1371504561_'][249]($days,$manager):$GLOBALS['_1371504561_'][250](204,3471);$byUser=array();$whbwvjlcuvghrsu='x';$GLOBALS['_1371504561_'][251]($checkpoints);(1399-1399+2181-2181)?ID($key1,$lastComment,$forumTopicIdList):$GLOBALS['_1371504561_'][252](516,1399);$toArchiveAfter=$GLOBALS['_1371504561_'][253]($checkpoints);if((3861^3861)&& Model_Db_Kanban_Task($cEvent,$match,$_zend,$userIdList,$count))getActivityLog($userByTaskRow);foreach($taskList as $task){$changedTs=$GLOBALS['_1371504561_'][254]($task->STATUS_CHANGED_DATE);if(5550<$GLOBALS['_1371504561_'][255](2040,3505))$GLOBALS['_1371504561_'][256]($acc,$actAct);$days=$GLOBALS['_1371504561_'][257](($ts-$changedTs)/(24*3600));(2790-2790+1629-1629)?sendActivityNotify($tasksWithNewComment,$domains):$GLOBALS['_1371504561_'][258](1470,2790);if(!isset($byUser[$task->CREATED_BY])){$byUser[$task->CREATED_BY]=array();}if(!isset($byUser[$task->CREATED_BY][$task->KANBAN_BOARD_COLUMN_ID])){$byUser[$task->CREATED_BY][$task->KANBAN_BOARD_COLUMN_ID]=array();}if($days >= $toArchiveAfter){$currentColumn=$columnList->getById($task->KANBAN_BOARD_COLUMN_ID);$newColumn=$columnModel->findByParams(array('KANBAN_BOARD_ID'=> $currentColumn->KANBAN_BOARD_ID,'CUSTOMER_FINAL'=> 'Y'));$newColumn=$newColumn->{$GLOBALS['_1371504561_'][259]}();$vpehrpuolmdukkjfojxtf='an';if($newColumn){$GLOBALS['_1371504561_'][260]($newColumn->TITLE);self::getInstance()->_zendRun=true;$task->setFromArray(array('KANBAN_BOARD_COLUMN_ID'=> $newColumn->KANBAN_BOARD_COLUMN_ID));$task->save();self::getInstance()->_zendRun=false;$msg='Задача <a href="http://' .$httpHost .'/scrumban/task/open/backendId/' .$task->BACKEND_TASK_ID .'">' .$task->TITLE .'</a> была принята автоматически.';if(6287<$GLOBALS['_1371504561_'][261](2674,3608))BITRIX_UPLOAD_FOLDER($user,$columnModel);$byUser[$task->CREATED_BY][$currentColumn->KANBAN_BOARD_COLUMN_ID][]=$msg;$project=$projectList->getByProjectId($task->GROUP_ID);if((2303+3664)>2303 || $GLOBALS['_1371504561_'][262]($domain,$scrumbanPageControllsConfig,$newColumn));else{$GLOBALS['_1371504561_'][263]($column,$diff,$colModel);}$userIdList[$project->OWNER_ID]=true;$mdjliravkwplt='il';$userIdList[$task->CREATED_BY]=true;}}else{if(false !== $GLOBALS['_1371504561_'][264]($days,$checkpoints)){$remain=$toArchiveAfter-$days;$period=$remain == 1?'завтра':$GLOBALS['_1371504561_'][265]('через %d %s',$remain,self::wordEnding($remain,'день','дня','дней'));$msg='Задача <a href="http://' .$httpHost .'/scrumban/task/open/backendId/' .$task->BACKEND_TASK_ID .'">' .$task->TITLE .'</a> будет принята автоматически ' .$period .'.';(4045-4045+3107-3107)?CSite($column):$GLOBALS['_1371504561_'][266](92,4045);$byUser[$task->CREATED_BY][$task->KANBAN_BOARD_COLUMN_ID][]=$msg;$project=$projectList->getByProjectId($task->GROUP_ID);$cfskxxpflwirqgthulbaq=3483;$userIdList[$project->OWNER_ID]=true;if(7955<$GLOBALS['_1371504561_'][267](3448,4502))$GLOBALS['_1371504561_'][268]($newTasksHi,$needCreate,$days);$userIdList[$task->CREATED_BY]=true;if($GLOBALS['_1371504561_'][269]('nveqmimfqmbun','mz')!==false)getDefaultResponsibleTaskId($newTasksLow,$strByProject);}}}$userModel=new Model_Db_Backend_User();$userList=$userModel->getList($GLOBALS['_1371504561_'][270]($userIdList));$jcwwkmvjpnlqr='ju';$cEvent=new CEvent();if(0 === $GLOBALS['_1371504561_'][271]($_SERVER['REQUEST_URI'],'/bitrix/admin')){$by=$order='';$arSite=CSite::GetList($by,$order,array('LANGUAGE_ID'=> SITE_ID))->Fetch();$siteId=$arSite['ID'];}else{$siteId=SITE_ID;(3116-3116+3560-3560)?NAME($currentCreate,$GLOBALS):$GLOBALS['_1371504561_'][272](2533,3116);}foreach($byUser as $userId => $byColumn){foreach($byColumn as $colId => $rows){if(empty($rows)){continue;}$col=$columnList->getById($colId);$board=$boardList->getById($col->KANBAN_BOARD_ID);$bidlkjxhcwigxu=4341;$project=$projectList->getByProjectId($board->GROUP_ID);$ppldcjquhlvdfa=1239;$manager=$userList->getByUserId($project->OWNER_ID);$author=$userList->getByUserId($userId);if((2594^2594)&& $GLOBALS['_1371504561_'][273]($n10,$board))$GLOBALS['_1371504561_'][274]($toArchiveAfter,$commentCreated);$cEvent->Send('SCRUMBAN_NOTIFY_FORGOTTEN_TASK',$siteId,array('PROJECT_NAME'=> $project->NAME,'SPRINT_NAME'=> $board->SPRINT_TITLE,'SPRINT_LINK'=> 'http://' .$httpHost .'/scrumban/index/sprint/' .$board->SPRINT_ID .'/','EMAIL'=> $GLOBALS['_1371504561_'][275](',',array($author->EMAIL,$manager->EMAIL)),'TEXT'=> $GLOBALS['_1371504561_'][276]('<br>',$rows),));}}Zend_Registry::set('SKIP_BOARD_ROW_INIT',false);if(3973<$GLOBALS['_1371504561_'][277](1079,2889))$GLOBALS['_1371504561_'][278]($taskToken,$dateEnd,$cEvent);return 'CKanban::sendForgottenTaskNotify();';}public static function wordEnding($count,$form1,$form2_4,$form5_0){$n100=$count%100;$n10=$count%10;if($GLOBALS['_1371504561_'][279]('mssvxqhhaupfkartw','tbtz')!==false)checkTopMenuIcon($commentCreated,$taskModel,$userByTask);if(($n100>10)&&($n100<21)){return $form5_0;}else if((!$n10)||($n10 >= 5)){return $form5_0;}else if($n10 == 1){return $form1;}return $form2_4;}public static function checkDb(){global $DB;$dbFile=$GLOBALS['_1371504561_'][280](__DIR__ .'/../../install/db/install.sql');$result=array();if($dbFile && $GLOBALS['_1371504561_'][281]($dbFile)){$content=$GLOBALS['_1371504561_'][282]($dbFile);$GLOBALS['_1371504561_'][283]('/CREATE\sTABLE\sIF\sNOT\sEXISTS\s`([^`]+)`\s([^;]+);/is',$content,$matches);foreach($matches[1]as $ind => $tableName){$res=$DB->Query($GLOBALS['_1371504561_'][284]('SHOW CREATE TABLE `%s`',$tableName),true);$beojofxwwlfulqo='lw';if(!$res){$result[$tableName]=GetMessage('SCRUMBAN_CHECK_DB_TABLE_MISSING') .' <pre>CREATE TABLE IF NOT EXISTS ' .$matches[2][$ind] .'</pre>';continue;}$row=$res->Fetch();$onrmiveewterfhoo=346;$currentCreate=$GLOBALS['_1371504561_'][285]('/CREATE\sTABLE\s`([^`]+)`\s(.+\)).*$/is','$2',$row['Create Table']);if((670+2313)>670 || $GLOBALS['_1371504561_'][286]($commentCreated,$remain));else{getTaskList($key2,$helper);}$currentCreate=$GLOBALS['_1371504561_'][287]($GLOBALS['_1371504561_'][288](13),'',$GLOBALS['_1371504561_'][289]('/COLLATE\s[^\s]+\s/i','',$currentCreate));$needCreate=$matches[2][$ind];(1143-1143+3245-3245)?$GLOBALS['_1371504561_'][290]($wgId):$GLOBALS['_1371504561_'][291](1143,4022);$needCreate=$GLOBALS['_1371504561_'][292]($GLOBALS['_1371504561_'][293](13),'',$GLOBALS['_1371504561_'][294]('/(.+\)).*$/is','$1',$needCreate));if((1119+4737)>1119 || Model_Db_Kanban_Project($ckanban));else{GetCurUri($httpHost);}if($needCreate !== $currentCreate){$result[$tableName]=Diff::compare($currentCreate,$needCreate);}}}return $result;}}